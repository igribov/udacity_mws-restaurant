"use strict";var map,restaurants=void 0,neighborhoods=void 0,cuisines=void 0,markers=[];function fetchNeighborhoods(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}function fillNeighborhoodsHTML(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})}function fetchCuisines(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}function fillCuisinesHTML(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})}function updateRestaurants(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,a=e[n].value,s=t[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(a,s,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}function resetRestaurants(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e}function fillRestaurantsHTML(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()}function createRestaurantHTML(e){var t=document.createElement("li");t.setAttribute("tabindex",0);var n=document.createElement("img");n.className="restaurant-img",n.src=DBHelper.imageUrlForRestaurant(e),n.setAttribute("alt",e.name),t.append(n);var r=document.createElement("div");r.className="restaurant-info";var a=document.createElement("h2");a.className="restaurant-card-name",a.setAttribute("tabindex","0"),a.innerHTML=e.name,r.append(a);var s=document.createElement("p");s.setAttribute("tabindex",0),s.innerHTML=e.neighborhood,r.append(s);var o=document.createElement("p");o.setAttribute("tabindex",0),o.innerHTML=e.address,r.append(o);var i=document.createElement("a");return i.innerHTML="View Details",i.href=DBHelper.urlForRestaurant(e),r.append(i),t.append(r),t}function addMarkersToMap(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})}document.addEventListener("DOMContentLoaded",function(e){registerServiceWorker(),fetchNeighborhoods(),fetchCuisines()}),window.initMap=function(){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsibmVpZ2hib3Job29kcyIsInJlc3RhdXJhbnRzIiwiY3Vpc2luZXMiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJEQkhlbHBlciIsImVycm9yIiwic2VsZiIsImNvbnNvbGUiLCJmaWxsTmVpZ2hib3Job29kc0hUTUwiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJzZWxlY3QiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZm9yRWFjaCIsIm5laWdoYm9yaG9vZCIsIm9wdGlvbiIsInZhbHVlIiwiZmV0Y2hDdWlzaW5lcyIsImZpbGxDdWlzaW5lc0hUTUwiLCJjdWlzaW5lIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInNjcm9sbHdoZWVsIiwiY1NlbGVjdCIsInVwZGF0ZVJlc3RhdXJhbnRzIiwiY0luZGV4Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsIm5TZWxlY3QiLCJyZXNldFJlc3RhdXJhbnRzIiwibWFya2VycyIsIm0iLCJzZXRNYXAiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwicmVzdGF1cmFudCIsInVsIiwiYXBwZW5kIiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJsaSIsInNldEF0dHJpYnV0ZSIsImltYWdlIiwic3JjIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwiYWRkTWFya2Vyc1RvTWFwIiwiaW5mb0Jsb2NrIiwiY2xhc3NOYW1lIiwibmFtZSIsImFkZHJlc3MiLCJtb3JlIiwiaHJlZiIsInVybEZvclJlc3RhdXJhbnQiLCJtYXAiLCJtYXJrZXIiLCJ1cmwiLCJwdXNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicmVnaXN0ZXJTZXJ2aWNlV29ya2VyIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsInpvb20iLCJjZW50ZXIiLCJsYXQiLCJsbmciLCJ3aW5kb3ciXSwibWFwcGluZ3MiOiJhQUFBLElBQ0VBLElBREVDLGlCQUFBQSxFQUNGRCxtQkFBQUEsRUFERkUsY0FB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WUUsR0FFakJELElBQUt6QixFQUFBQSxTQUFZYSxjQUFqQixLQU1BVSxPQUxBQSxFQUFBQSxVQUFpQkUsZUFjakJFLEVBQUtDLEtBQU8vQyxTQUFTZ0QsaUJBQWlCaEIsR0FadENVLEVBQU05QixPQUFBQSxHQUNOQSxFQUFBQSxPQUFBQSxHQUVBOEIsRUFtQkYsU0FBU0QsbUJBQWdELEVBQUFwQyxVQUFBQyxhQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBbEJILEtBQUtMLGFBWjdCWSxRQUFTUyxTQUFBQSxHQUV0QjRCLElBQUtDLEVBQU8vQyxTQUFTZ0QsdUJBQXJCaEIsRUFBQTlCLEtBQUErQyxLQUNBUCxPQUFBQSxLQUFVUixNQUFPWSxZQUFqQkksRUFBQSxRQUFBLFdBQ0doQixPQUFPUSxTQUFWSyxLQUFBRyxFQUFBQyxNQUVBakQsS0FBT2tDLFFBQVBnQixLQUFBRixLQXBLRnpDLFNBQVM0QyxpQkFBaUIsbUJBQW9CLFNBQUNDLEdBQzdDQyx3QkFERjlDLHFCQUNFOEMsa0JBdURFMUMsT0FBQUEsUUFBQSxXQUtKWCxLQUFBK0MsSUFBQSxJQUFBTyxPQUFBQyxLQUFBQyxJQUFBakQsU0FBQUMsZUFBQSxPQUFBLENBU0lpRCxLQUFNLEdBQ05DLE9BZE8xQixDQUpUMkIsSUFBQSxVQU1EQyxLQUFBLFdBS0RDLGFBQWlCLElBRWJGIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudHMsXHJcbiAgbmVpZ2hib3Job29kcyxcclxuICBjdWlzaW5lcztcclxudmFyIG1hcDtcclxudmFyIG1hcmtlcnMgPSBbXTtcclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBuZWlnaGJvcmhvb2RzIGFuZCBjdWlzaW5lcyBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcclxuICByZWdpc3RlclNlcnZpY2VXb3JrZXIoKTtcclxuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICBmZXRjaEN1aXNpbmVzKCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZ1bmN0aW9uIGZldGNoTmVpZ2hib3Job29kcygpIHtcclxuICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5uZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcztcclxuICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4gKi9cclxuZnVuY3Rpb24gZmlsbE5laWdoYm9yaG9vZHNIVE1MKG5laWdoYm9yaG9vZHMgPSBzZWxmLm5laWdoYm9yaG9vZHMpIHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuICBuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcclxuICAgIG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mdW5jdGlvbiBmZXRjaEN1aXNpbmVzKCkge1xyXG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLmN1aXNpbmVzID0gY3Vpc2luZXM7XHJcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxyXG4gKi9cclxuZnVuY3Rpb24gZmlsbEN1aXNpbmVzSFRNTChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpIHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcblxyXG4gIGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBjdWlzaW5lO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGxldCBsb2MgPSB7XHJcbiAgICBsYXQ6IDQwLjcyMjIxNixcclxuICAgIGxuZzogLTczLjk4NzUwMVxyXG4gIH07XHJcbiAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgem9vbTogMTIsXHJcbiAgICBjZW50ZXI6IGxvYyxcclxuICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gIH0pO1xyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogVXBkYXRlIHBhZ2UgYW5kIG1hcCBmb3IgY3VycmVudCByZXN0YXVyYW50cy5cclxuICovXHJcbmZ1bmN0aW9uIHVwZGF0ZVJlc3RhdXJhbnRzKCkge1xyXG4gIGNvbnN0IGNTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcbiAgY29uc3QgblNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG5cclxuICBjb25zdCBjSW5kZXggPSBjU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcbiAgY29uc3QgbkluZGV4ID0gblNlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG5cclxuICBjb25zdCBjdWlzaW5lID0gY1NlbGVjdFtjSW5kZXhdLnZhbHVlO1xyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IG5TZWxlY3RbbkluZGV4XS52YWx1ZTtcclxuXHJcbiAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcclxuICAgICAgZmlsbFJlc3RhdXJhbnRzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiAqL1xyXG5mdW5jdGlvbiByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKSB7XHJcbiAgLy8gUmVtb3ZlIGFsbCByZXN0YXVyYW50c1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgdWwuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcclxuICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtID0+IG0uc2V0TWFwKG51bGwpKTtcclxuICBzZWxmLm1hcmtlcnMgPSBbXTtcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHM7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJlc3RhdXJhbnRzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZnVuY3Rpb24gZmlsbFJlc3RhdXJhbnRzSFRNTChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpIHtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSk7XHJcbiAgfSk7XHJcbiAgYWRkTWFya2Vyc1RvTWFwKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MLlxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCkge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBsaS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XHJcblxyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgaW1hZ2Uuc2V0QXR0cmlidXRlKCdhbHQnLCByZXN0YXVyYW50Lm5hbWUpO1xyXG4gIGxpLmFwcGVuZChpbWFnZSk7XHJcblxyXG4gIGNvbnN0IGluZm9CbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIGluZm9CbG9jay5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbmZvJztcclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XHJcbiAgbmFtZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1jYXJkLW5hbWUnO1xyXG4gIG5hbWUuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgaW5mb0Jsb2NrLmFwcGVuZChuYW1lKTtcclxuXHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIG5laWdoYm9yaG9vZC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XHJcbiAgbmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xyXG4gIGluZm9CbG9jay5hcHBlbmQobmVpZ2hib3Job29kKTtcclxuXHJcbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBhZGRyZXNzLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcclxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcclxuICBpbmZvQmxvY2suYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gIG1vcmUuaW5uZXJIVE1MID0gJ1ZpZXcgRGV0YWlscyc7XHJcbiAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBpbmZvQmxvY2suYXBwZW5kKG1vcmUpO1xyXG4gIGxpLmFwcGVuZChpbmZvQmxvY2spO1xyXG5cclxuICByZXR1cm4gbGlcclxufVxyXG5cclxuLyoqXHJcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXHJcbiAqL1xyXG5mdW5jdGlvbiBhZGRNYXJrZXJzVG9NYXAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICB9KTtcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcbn1cclxuIl19
